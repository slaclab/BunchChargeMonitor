#For these to provide usable data the coefficients A0 and A1 must be set 1

record(calcout, "$(P):$(CHAN):Calib_Charge")
{
     field(DESC, "Integration of the beam pulse")
     field(EGU, "mV*ns/ohms")
     field(SCAN, "1 second")
     field(INPA, "$(P):$(CHAN):Calib_mV")
     field(INPB, "$(P):$(CHAN):NumSamp1_H")
     field(INPC, "$(P):$(CHAN):CLK_PERIOD")
     field(CALC, "A*B*C/50")
}

record(calcout, "$(P):$(CHAN):INTEGRAL")
{
     field(DESC, "Integration of the beam pulse")
     field(EGU, "mV*ns")
     field(SCAN, "1 second")
     field(INPA, "$(P):$(CHAN):Calib_Conversion")
     field(INPB, "$(P):$(CHAN):NumSamp1_H")
     field(INPC, "$(P):$(CHAN):CLK_PERIOD")
     field(CALC, "A*B*C")
}

record(ai, "$(P):$(CHAN):Calib_mV")
{
    field(DESC, "Measured voltage")
    field(EGU, "mV")
    field(AOFF, "0")
    field(ASLO, "0.0192")
    field(SCAN, "1 second")
    field(INP, "$(P):$(CHAN):TMIT_PC")
    field(DTYP, "Raw Soft Channel")
    field(FLNK, "$(P):$(CHAN):Calib_Charge")
    info(autosaveFields, "AOFF ASLO")
}

record(ao, "$(P):$(CHAN):Calib_Conversion")
{
    field(DESC, "ratio of acd counts to mV")
    field(EGU, "mV/count")
    field(SCAN, "Passive")
    field(VAL, "0.0192")
    info(autosaveFields, "VAL")   
}

record(calcout, "$(P):$(CHAN):Calib_Coef_A0")
{
     field(DESC, "Converts Calib_charge to coef magnitude")
     field(EGU, "N/A")
     field(SCAN, "1 second")
     field(INPA, "$(P):$(CHAN):INTEGRAL")
     field(INPB, "$(P):$(CHAN):Calib_ratio")
     field(INPC, "$(P):$(CHAN):Invert_Coef")
     field(CALC, "C*A/(50*B)")
     field(OUT, "$(P):$(CHAN):CoefA0")
     field(FLNK, "$(P):$(CHAN):CoefA0")
}

record(calcout, "$(P):$(CHAN):Calib_Coef_A1")
{
     field(DESC, "Converts Calib_charge to coef magnitude")
     field(EGU, "N/A")
     field(SCAN, "1 second")
     field(INPA, "$(P):$(CHAN):INTEGRAL")
     field(INPB, "$(P):$(CHAN):Calib_ratio")
     field(INPC, "$(P):$(CHAN):Invert_Coef")
     field(CALC, "-C*A/(50*B)")
     field(OUT, "$(P):$(CHAN):CoefA1")
     field(FLNK, "$(P):$(CHAN):CoefA1")
}

record(ao, "$(P):$(CHAN):Calib_ratio")
{
    field(DESC, "Toroid Response Ratio")
    field(EGU, "N/A")
    field(VAL, "0.0754")
    field(SCAN, "Passive")
}

record(ao, "$(P):$(CHAN):Invert_Coef")
{
    field(DESC, "If coefA0 should be positive")
    field(EGU, "N/A")
    field(VAL, "1")
    field(SCAN, "Passive")
}
